<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³ ê° ê°ì‚¬ ì´ë²¤íŠ¸ ë£°ë ›</title>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        * {
            box-sizing: border-box;
            font-family: 'Pretendard', sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #f0f2f5;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        h1 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .roulette-container {
            position: relative;
            width: 380px;
            height: 380px;
            margin: 20px;
        }

        canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1); /* ë¶€ë“œëŸ¬ìš´ ê°ì† íš¨ê³¼ */
        }

        /* í™”ì‚´í‘œ (í¬ì¸í„°) */
        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ff3e3e;
            z-index: 10;
            filter: drop-shadow(0 2px 2px rgba(0,0,0,0.3));
        }

        button {
            margin-top: 30px;
            padding: 15px 50px;
            font-size: 1.2rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
            transition: transform 0.2s;
        }

        button:active {
            transform: scale(0.95);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* ê²°ê³¼ ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            animation: popUp 0.3s ease-out;
        }

        .modal h2 { color: #ff6b6b; }
        .close-btn {
            margin-top: 20px;
            padding: 10px 30px;
            background: #333;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        @keyframes popUp {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* ëª¨ë°”ì¼ ëŒ€ì‘ */
        @media (max-width: 400px) {
            .roulette-container {
                width: 300px;
                height: 300px;
            }
        }
    </style>
</head>
<body>

    <h1>ğŸ í–‰ìš´ì˜ ë£°ë › ì´ë²¤íŠ¸</h1>

    <div class="roulette-container">
        <div class="pointer"></div>
        <canvas id="rouletteCanvas" width="500" height="500"></canvas>
    </div>

    <button id="spinBtn" onclick="spin()">ëŒë¦¬ê¸° START!</button>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <h2 id="resultText">ë‹¹ì²¨ ë‚´ìš©</h2>
            <p>ì¶•í•˜í•©ë‹ˆë‹¤! ê²½í’ˆì´ ì§€ê¸‰ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            <button class="close-btn" onclick="closeModal()">ë‹«ê¸°</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('rouletteCanvas');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');

        // ğŸŸ¢ ìˆ˜ì • ê°€ëŠ¥í•œ ë¶€ë¶„: ìƒí’ˆ ëª©ë¡ê³¼ ìƒ‰ìƒ
        // í™•ë¥  ì¡°ì‘ì´ í•„ìš”í•˜ë©´ ë³„ë„ ë¡œì§ì´ í•„ìš”í•˜ì§€ë§Œ, ì§€ê¸ˆì€ ê· ë“± í™•ë¥ ì…ë‹ˆë‹¤.
        const product = [
            "ìŠ¤íƒ€ë²…ìŠ¤ ì¿ í°", "ê½ (ë‹¤ìŒ ê¸°íšŒì—)", "ë°°ë‹¬ë¹„ ë¬´ë£Œ", "10% í• ì¸ì¿ í°", 
            "í¬ì¸íŠ¸ 1,000P", "ê½ (ì•„ì‰½ë„¤ìš”)", "50% í• ì¸ì¿ í°", "ì¹˜í‚¨ êµí™˜ê¶Œ"
        ];
        
        const colors = [
            "#FFD1DC", "#E0F7FA", "#FFECB3", "#D1C4E9", 
            "#FFCCBC", "#F0F4C3", "#B2DFDB", "#FFCDD2"
        ];

        const newMake = () => {
            const [cw, ch] = [canvas.width / 2, canvas.height / 2];
            const arc = Math.PI / (product.length / 2);
          
            for (let i = 0; i < product.length; i++) {
                ctx.beginPath();
                ctx.fillStyle = colors[i % colors.length];
                ctx.moveTo(cw, ch);
                ctx.arc(cw, ch, cw, arc * (i - 1), arc * i);
                ctx.fill();
                ctx.closePath();
            }

            ctx.fillStyle = "#333";
            ctx.font = "bold 24px Pretendard";
            ctx.textAlign = "center";

            for (let i = 0; i < product.length; i++) {
                const angle = (arc * i) + (arc / 2);

                ctx.save();
                ctx.translate(
                    cw + Math.cos(angle + (Math.PI * 1.5) + 0.15) * (cw - 80), // í…ìŠ¤íŠ¸ ìœ„ì¹˜ ì¡°ì •
                    ch + Math.sin(angle + (Math.PI * 1.5) + 0.15) * (cw - 80)
                );
                
                // í…ìŠ¤íŠ¸ íšŒì „ (ì¤‘ì‹¬ì¶• ê¸°ì¤€)
                ctx.rotate(angle + Math.PI / 2); 

                // í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ì²˜ë¦¬ (ê°„ë‹¨í•œ ë²„ì „)
                const text = product[i];
                product[i].split(" ").forEach((t, j) => {
                    ctx.fillText(t, 0, 30 * j);
                });
                
                ctx.restore();
            }
        }

        let currentRotation = 0; // í˜„ì¬ íšŒì „ ê°ë„

        const spin = () => {
            spinBtn.disabled = true; // ë²„íŠ¼ ë¹„í™œì„±í™”
            
            // ëœë¤ íšŒì „ ê°ë„ ì„¤ì • (ê¸°ë³¸ 5ë°”í€´ + ëœë¤ ê°ë„)
            const randomDeg = Math.floor(2000 + Math.random() * 2000); 
            currentRotation += randomDeg;
            
            // CSS transformì„ ì´ìš©í•œ íšŒì „ ì• ë‹ˆë©”ì´ì…˜
            canvas.style.transform = `rotate(${currentRotation}deg)`;

            // 4ì´ˆ(CSS transition ì‹œê°„) ë’¤ì— ê²°ê³¼ ê³„ì‚°
            setTimeout(() => {
                const actualDeg = currentRotation % 360;
                const segmentAngle = 360 / product.length;
                
                // í™”ì‚´í‘œê°€ ê°€ë¦¬í‚¤ëŠ” ìœ„ì¹˜ ê³„ì‚° (CanvasëŠ” 0ë„ê°€ 3ì‹œ ë°©í–¥ì´ë¯€ë¡œ ë³´ì • í•„ìš”)
                // CSS rotateëŠ” ì‹œê³„ë°©í–¥, í¬ì¸í„°ëŠ” ìƒë‹¨(270ë„/-90ë„) ê³ ì •
                // ìƒë‹¨(0ë„) ê¸°ì¤€ìœ¼ë¡œ ë³´ì •í•˜ì—¬ ê³„ì‚°
                
                // ì‹¤ì œ ë‹¹ì²¨ ì¸ë±ìŠ¤ ê³„ì‚° ë¡œì§
                // 360ë„ì—ì„œ íšŒì „í•œ ë‚˜ë¨¸ì§€ ê°ë„ë¥¼ ë¹¼ì„œ ì—­ì‚°
                let winningIndex = Math.floor((360 - actualDeg + 90) % 360 / segmentAngle); 
                // ë°°ì—´ ì¸ë±ìŠ¤ ë³´ì • (ìŒìˆ˜ ë°©ì§€ ë“± í•„ìš”ì‹œ)
                winningIndex = (winningIndex + product.length) % product.length;

                // ë§ˆì§€ë§‰ í…ìŠ¤íŠ¸ ë Œë”ë§ ìˆœì„œì™€ ìº”ë²„ìŠ¤ ê·¸ë¦¬ê¸° ìˆœì„œ ì°¨ì´ ë³´ì • (í•„ìš” ì‹œ ë¯¸ì„¸ì¡°ì •)
                // í˜„ì¬ ë¡œì§ìƒ ì‹œê³„ë°©í–¥ ê·¸ë¦¼ -> ì¸ë±ìŠ¤ ì—­ìˆœ ë‹¹ì²¨
                
                const winner = product[winningIndex];
                showResult(winner);
                
                spinBtn.disabled = false;
            }, 4000);
        };

        const showResult = (winner) => {
            const resultText = document.getElementById('resultText');
            const modal = document.getElementById('resultModal');
            
            resultText.innerText = `ğŸ‰ ${winner} ë‹¹ì²¨!`;
            modal.style.display = 'flex';
        };

        const closeModal = () => {
            document.getElementById('resultModal').style.display = 'none';
        }

        // ì´ˆê¸° ë£°ë › ê·¸ë¦¬ê¸°
        newMake();
    </script>
</body>
</html>
